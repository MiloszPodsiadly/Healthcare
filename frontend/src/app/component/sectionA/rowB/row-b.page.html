<main class="wrap rowb">
  <header class="header">
    <h1>ğŸ’ª Exercise Review</h1>
    <p class="subtitle">Find the right exercise, check the step-by-step instructions and add to your favorites</p>
  </header>

  <section class="band">
    <div class="filters">
      <input
        type="text"
        [(ngModel)]="q"
        (input)="onFiltersChanged()"
        placeholder="ğŸ” Search by exercise nameâ€¦"
      />
      <input
        type="text"
        [(ngModel)]="bodyPart"
        (input)="onFiltersChanged()"
        placeholder="ğŸ§©Body part (e.g. chest)"
      />
      <input
        type="text"
        [(ngModel)]="equipment"
        (input)="onFiltersChanged()"
        placeholder="ğŸ‹ï¸ Equipment (e.g. barbell)"
      />

      <select [(ngModel)]="pageSize" (change)="onFiltersChanged()" aria-label="Quantity per page">
        <option [ngValue]="10">10 / page</option>
        <option [ngValue]="20">20 / page</option>
        <option [ngValue]="50">50 / page</option>
      </select>

      <button class="btn primary" (click)="search()">Search</button>
      <button class="btn ghost" (click)="clearFilters()">Clear</button>
    </div>
  </section>

  <section class="empty card" *ngIf="loading || (!loading && !results.length)">
    <ng-container *ngIf="loading; else nores">
      <div class="spinner"></div>
      <p>Loading exercisesâ€¦</p>
    </ng-container>
    <ng-template #nores>
      <p>No results for the selected filters.</p>
    </ng-template>
  </section>

  <section class="ex-list" *ngIf="!loading && results.length">
    <article class="ex card" *ngFor="let ex of results">
      <div class="ex-image" *ngIf="ex.image">
        <img [src]="ex.image" [alt]="ex.name" loading="lazy" />
      </div>

      <div class="ex-body">
        <h2 class="ex-title">{{ ex.name }}</h2>

        <div class="ex-tags">
          <span class="tag">ğŸ§© {{ ex.bodyPart || 'without indication' }}</span>
          <span class="tag" *ngIf="ex.target">ğŸ¯ {{ ex.target }}</span>
          <span class="tag eq" *ngIf="ex.equipment">ğŸ‹ï¸ {{ ex.equipment }}</span>
          <span class="tag" *ngFor="let s of ex.secondaryMuscles">â• {{ s }}</span>
        </div>

        <h4 class="section-title" *ngIf="ex.instructions?.length">How to perform</h4>
        <ul class="steps" *ngIf="ex.instructions?.length; else noinst">
          <li *ngFor="let step of ex.instructions">{{ step }}</li>
        </ul>
        <ng-template #noinst>
          <p class="ex-desc">There are no instructions for this exercise.</p>
        </ng-template>
      </div>

      <footer class="ex-footer">
        <button class="btn" [class.primary]="isFav(ex.id)" (click)="toggleFav(ex)">
          {{ isFav(ex.id) ? 'â˜… Favorites' : 'â˜† Add to favorites' }}
        </button>
        <a class="btn ghost" [href]="sourceLink" target="_blank" rel="noopener">Data source â†—</a>
      </footer>
    </article>

    <div class="pager" *ngIf="totalPages > 1">
      <button class="btn" (click)="setPage(page-1)" [disabled]="page<=1">â€¹ Previous</button>
      <span>Strona {{ page }} / {{ totalPages }}</span>
      <button class="btn" (click)="setPage(page+1)" [disabled]="page>=totalPages">Next â€º</button>
    </div>
  </section>
</main>
