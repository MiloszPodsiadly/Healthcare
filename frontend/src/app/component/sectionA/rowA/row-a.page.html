<main class="wrap">
  <header class="header">
    <h1>Daily preview</h1>
    <p class="subtitle">Your health today</p>
    <div class="status">
      <span class="badge">Next reset in: {{ nextResetCountdown }}</span>
      <button class="btn ghost" (click)="archiveNow()" title="Save your daily status and reset your counters">Save now</button>
    </div>
  </header>

  <section class="grid grid-top">
    <article class="card" data-widget="steps">
      <div class="card-head">
        <div class="icon">ğŸ¦¶</div>
        <div>
          <h3>Steps</h3>
          <small>Today's progress</small>
        </div>
      </div>

      <div class="metric">
        <span class="value">{{ state.steps | number:'1.0-0' }}</span>
      </div>

      <div class="progress">
        <div class="bar" [style.width.%]="pct(state.steps, state.stepsGoal)"></div>
      </div>
      <div class="goal">
        <small>from</small>
        <span>{{ state.stepsGoal | number:'1.0-0' }}</span>
        <small>steps</small>
      </div>
      <div class="goal-controls">
        <button class="btn" (click)="changeGoal('stepsGoal', 500)">+500</button>
        <button class="btn ghost" (click)="changeGoal('stepsGoal', -500)">-500</button>
        <button class="btn warn" (click)="editGoal('stepsGoal')">Edit goal</button>
      </div>

      <div class="actions">
        <button class="btn" (click)="addSteps(1000)">+1000</button>
        <button class="btn ghost" (click)="addSteps(-100)">-100</button>
        <button class="btn warn" (click)="editSteps()">Edit score</button>
      </div>
    </article>

    <article class="card" data-widget="water">
      <div class="card-head">
        <div class="icon">ğŸ’§</div>
        <div>
          <h3>Water</h3>
          <small>Hydration of the body</small>
        </div>
      </div>

      <div class="metric">
        <span class="value">{{ state.water | number:'1.0-1' }}</span>
        <span class="unit">L</span>
      </div>

      <div class="progress">
        <div class="bar" [style.width.%]="pct(state.water, state.waterGoal)"></div>
      </div>
      <div class="goal">
        <small>from</small>
        <span>{{ state.waterGoal | number:'1.0-1' }}</span>
        <small>L daily</small>
      </div>
      <div class="goal-controls">
        <button class="btn" (click)="changeGoal('waterGoal', 0.25)">+0.25 L</button>
        <button class="btn ghost" (click)="changeGoal('waterGoal', -0.25)">-0.25 L</button>
        <button class="btn warn" (click)="editGoal('waterGoal')">Edit goal</button>
      </div>

      <div class="actions">
        <button class="btn" (click)="addWater(0.25)">+0.25 L</button>
        <button class="btn ghost" (click)="addWater(-0.1)">-0.1 L</button>
        <button class="btn warn" (click)="editWater()">Edit score</button>
      </div>
    </article>

    <article class="card" data-widget="sleep">
      <div class="card-head">
        <div class="icon">ğŸ˜´</div>
        <div>
          <h3>Sleep</h3>
          <small>Last night</small>
        </div>
      </div>

      <div class="metric">
        <span class="value">{{ state.sleep | number:'1.0-1' }}</span>
        <span class="unit">h</span>
      </div>

      <div class="progress">
        <div class="bar" [style.width.%]="pct(state.sleep, state.sleepGoal)"></div>
      </div>
      <div class="goal">
        <small>from</small>
        <span>{{ state.sleepGoal }}</span>
        <small>h recommended</small>
      </div>
      <div class="goal-controls">
        <button class="btn" (click)="changeGoal('sleepGoal', 0.5)">+0.5 h</button>
        <button class="btn ghost" (click)="changeGoal('sleepGoal', -0.5)">-0.5 h</button>
        <button class="btn warn" (click)="editGoal('sleepGoal')">Edit goal</button>
      </div>

      <div class="actions">
        <button class="btn warn" (click)="editSleep()">Edit score</button>
      </div>
    </article>
  </section>

  <section class="grid">
    <article class="card tall" data-widget="exercise">
      <div class="card-head">
        <div class="icon">ğŸ‹ï¸</div>
        <div>
          <h3>Exercises</h3>
          <small>Physical activity</small>
        </div>
      </div>

      <div class="metric">
        <span class="value">{{ state.exercise | number:'1.0-0' }}</span>
        <span class="unit">min</span>
      </div>

      <div class="progress">
        <div class="bar danger" [style.width.%]="pct(state.exercise, state.exerciseGoal)"></div>
      </div>
      <div class="goal">
        <small>from</small>
        <span>{{ state.exerciseGoal }}</span>
        <small>min daily</small>
      </div>
      <div class="goal-controls">
        <button class="btn" (click)="changeGoal('exerciseGoal', 5)">+5 min</button>
        <button class="btn ghost" (click)="changeGoal('exerciseGoal', -5)">-5 min</button>
        <button class="btn warn" (click)="editGoal('exerciseGoal')">Edit goal</button>
      </div>

      <div class="actions">
        <button class="btn" (click)="addExercise(10)">+10 min</button>
        <button class="btn ghost" (click)="addExercise(-5)">-5 min</button>
        <button class="btn warn" (click)="editExercise()">Edit score</button>
      </div>
    </article>

    <article class="card tall kcal" data-widget="calories">
      <div class="card-head">
        <div class="icon">ğŸ½ï¸</div>
        <div>
          <h3>Calories</h3>
          <small>Delivered with food</small>
        </div>
      </div>

      <div class="metric">
        <span class="value">{{ state.calories | number:'1.0-0' }}</span>
        <span class="unit">kcal</span>
      </div>

      <div class="progress">
        <div class="bar kcal" [style.width.%]="pct(state.calories, state.caloriesGoal)"></div>
      </div>
      <div class="goal">
        <small>from</small>
        <span>{{ state.caloriesGoal | number:'1.0-0' }}</span>
        <small>kcal daily</small>
      </div>
      <div class="goal-controls">
        <button class="btn" (click)="changeGoal('caloriesGoal', 100)">+100</button>
        <button class="btn ghost" (click)="changeGoal('caloriesGoal', -100)">-100</button>
        <button class="btn warn" (click)="editGoal('caloriesGoal')">Edit goal</button>
      </div>

      <div class="actions">
        <button class="btn" (click)="addCalories(100)">+100</button>
        <button class="btn ghost" (click)="addCalories(-50)">-50</button>
        <button class="btn warn" (click)="editCalories()">Edit score</button>
      </div>
    </article>
  </section>

  <section class="mood card">
    <div class="card-head">
      <div class="icon">ğŸŒ¤ï¸</div>
      <div>
        <h3>Mood</h3>
        <small>How are you feeling today?</small>
      </div>
    </div>

    <div class="mood-row" id="moodRow">
      <button class="mood-btn" [class.active]="state.mood===1" (click)="setMood(1)" title="Sad">ğŸ˜Ÿ</button>
      <button class="mood-btn" [class.active]="state.mood===2" (click)="setMood(2)" title="Not great">ğŸ™‚</button>
      <button class="mood-btn" [class.active]="state.mood===3" (click)="setMood(3)" title="OK">ğŸ˜Š</button>
      <button class="mood-btn" [class.active]="state.mood===4" (click)="setMood(4)" title="Content">ğŸ˜‹</button>
      <button class="mood-btn" [class.active]="state.mood===5" (click)="setMood(5)" title="Great!">ğŸ¤©</button>
    </div>

    <label class="note-label" for="moodNote">Optional note on moodâ€¦</label>
    <textarea id="moodNote" rows="3" [value]="state.moodNote" (input)="onMoodNoteInput($event)" placeholder="Add a short comment"></textarea>
  </section>
</main>

<div class="modal-overlay" [class.open]="_modal.open" (click)="closeModal($event)">
  <div class="modal" (click)="$event.stopPropagation()">
    <h3>{{ _modal.title }}</h3>
    <p>{{ _modal.label }}</p>
    <div class="row">
      <input
        #num
        type="number"
        [step]="_modal.step"
        [min]="_modal.min"
        [max]="_modal.max"
        [value]="_modal.value"
        (keydown.enter)="confirmModal(num.value)"
        autofocus
      />
    </div>
    <div class="actions">
      <button class="btn ghost" (click)="hideModal()">Cancel</button>
      <button class="btn" (click)="confirmModal(num.value)">OK</button>
    </div>
  </div>
</div>
